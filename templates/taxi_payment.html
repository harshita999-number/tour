{% load static %}
<h2>Taxi Booking Payment</h2>

<div id="paypal-button-container"></div>

<script src="https://www.paypal.com/sdk/js?client-id={{paypal_client_id}}&currency=USD"></script>

<script>
paypal.Buttons({

    createOrder: function() {
        return fetch("/create-taxi-order")
        .then(res => res.json())
        .then(data => data.orderID);
    },

    onApprove: function(data) {
        return fetch("/capture-taxi-order", {
            method: "post",
            headers: {"Content-Type": "application/json"},
            body: JSON.stringify({
                orderID: data.orderID
            })
        }).then(function() {
            window.location.href = "/taxi-history";
        });
    },

    onCancel: function () {
        alert("Payment Cancelled ‚ùå");
        window.location.href = "/index3";
    }

}).render('#paypal-button-container');
</script>